<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>NFT Shooter Mobile</title>

  <!-- Libraries -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/web3@4/dist/web3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>

  <!-- Game Logic -->
  <script src="jame.js" defer></script>

  <style>
    :root {
      --bg: #0f172a;
      --card: #1e293b;
      --text: #f1f5f9;
      --light: #cbd5e1;
      --accent: #3b82f6;
      --green: #10b981;
      --red: #ef4444;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow: hidden;
      touch-action: none;
      -webkit-tap-highlight-color: transparent;
    }

    /* Header */
    header {
      position: fixed;
      top: 0; left: 0; right: 0;
      background: rgba(30,41,59,0.95);
      padding: 10px;
      text-align: center;
      z-index: 100;
      backdrop-filter: blur(10px);
    }
    h1 { font-size: 1.1rem;: 1.1rem; margin: 0; }
    #walletStatus { font-size: 0.75rem; color: var(--light); margin: 4px 0; }
    #connectBtn {
      padding: 6px 12px; font-size: 0.75rem;
      background: var(--accent); color: white;
      border: none; border-radius: 6px; cursor: pointer;
    }

    /* Canvas */
    #canvas-container { position: fixed; inset: 0; z-index: 1; }

    /* Instructions */
    #instructions {
      position: fixed;
      bottom: 0; left: 0; right: 0;
      background: rgba(0,0,0,0.8);
      color: white; padding: 8px;
      text-align: center; font-size: 0.8rem;
      z-index: 100; backdrop-filter: blur(10px);
    }

    /* Mobile Controls */
    #mobile-controls {
      position: fixed; bottom: 70px; right: 10px;
      display: flex; flex-direction: column; gap: 8px; z-index: 100;
    }
    .mobile-btn {
      width: 50px; height: 50px; border-radius: 50%;
      background: rgba(59,130,246,0.9); color: white;
      font-size: 1.2rem; font-weight: bold;
      display: flex; align-items: center; justify-content: center;
      border: 2px solid rgba(255,255,255,0.3);
      box-shadow: 0 3px 8px rgba(0,0,0,0.3);
    }
    #shoot-btn { background: rgba(239,68,68,0.9); }

    #look-controls {
      position: fixed; bottom: 70px; left: 10px;
      width: 110px; height: 110px;
      background: rgba(0,0,0,0.3); border-radius: 50%;
      border: 2px solid rgba(255,255,255,0.2); z-index: 100;
    }

    /* Sidebar Toggle */
    #sidebar-toggle {
      position: fixed; top: 60px; left: 10px;
      width: 45px; height: 45px; background: rgba(0,0,0,0.9);
      border: 2px solid var(--accent); color: white; font-size: 1.3rem;
      border-radius: 50%; display: flex; align-items: center;
      justify-content: center; z-index: 95; box-shadow: 0 3px 8px rgba(0,0,0,0.3);
    }

    /* Sidebar */
    #sidebar {
      position: fixed; top: 60px; left: 60px; width: 260px;
      height: calc(100% - 70px); background: rgba(15,23,42,0.95);
      border-radius: 14px; display: none; flex-direction: column;
      overflow: hidden; z-index: 90; box-shadow: 0 8px 25px rgba(0,0,0,0.5);
      border: 1px solid rgba(59,130,246,0.3); backdrop-filter: blur(12px);
    }
    #sidebar.active { display: flex; z-index: 1000; }
    #sidebar-content { flex: 1; padding: 16px; overflow-y: auto; }

    .section { margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid rgba(59,130,246,0.3); }
    .section:last-child { border: none; }
    .section h3 { font-size: 1rem; color: var(--accent); margin-bottom: 10px; display: flex; align-items: center; gap: 6px; }
    .info { display: flex; justify-content: space-between; margin: 8px 0; font-size: 0.85rem; }
    .label { color: #94a3b8; }
    .value { font-weight: 600; color: white; }

    .btn {
      width: 100%; padding: 10px; margin: 8px 0;
      background: var(--accent); color: white; border: none;
      border-radius: 8px; font-size: 0.85rem; cursor: pointer;
    }
    .btn-green { background: var(--green); }

    /* Avatar Selection */
    #avatar-selection {
      position: fixed; inset: 0; background: rgba(15,23,42,0.97);
      display: flex; flex-direction: column; align-items: center;
      justify-content: center; z-index: 2000; padding: 20px;
      backdrop-filter: blur(10px);
    }
    #avatar-selection h2 { font-size: 1.6rem; margin-bottom: 20px; text-align: center; }
    .avatar-options { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; margin: 20px 0; }
    .avatar-option {
      width: 130px; height: 170px; border-radius: 14px; overflow: hidden;
      cursor: pointer; border: 3px solid transparent; position: relative;
      background: #333; transition: 0.3s;
    }
    .avatar-option::after {
      content: attr(data-avatar); position: absolute; bottom: 12px; left: 0; right: 0;
      text-align: center; color: white; font-weight: bold; text-transform: capitalize;
    }
    .avatar-option.selected { border-color: var(--accent); box-shadow: 0 0 20px var(--accent); }
    #boy-avatar { background: linear-gradient(135deg, #3b82f6, #1e40af); }
    #girl-avatar { background: linear-gradient(135deg, #ec4899, #be185d); }

    #player-name {
      width: 220px; padding: 12px; margin: 15px 0;
      border: 2px solid rgba(59,130,246,0.5); border-radius: 8px;
      background: rgba(30,41,59,0.8); color: white; text-align: center;
      font-size: 1rem;
    }
    #confirm-avatar {
      padding: 12px 28px; background: var(--accent); color: white;
      border: none; border-radius: 8px; font-size: 1rem; cursor: pointer;
      margin-top: 10px;
    }

    /* Modals */
    .modal {
      display: none; position: fixed; top: 50%; left: 50%;
      transform: translate(-50%, -50%); background: var(--card);
      padding: 20px; border-radius: 14px; width: 90%; max-width: 380px;
      max-height: 80vh; overflow-y: auto; z-index: 1000;
      box-shadow: 0 8px 25px rgba(0,0,0,0.4); border: 1px solid rgba(59,130,246,0.3);
    }
    .modal-close {
      position: absolute; top: 10px; right: 10px;
      width: 30px; height: 30px; background: var(--red);
      border-radius: 50%; color: white; font-size: 0.9rem;
      display: flex; align-items: center; justify-content: center;
    }

    .token-balance { background: rgba(59,130,246,0.1); padding: 12px; border-radius: 8px; text-align: center; margin: 12px 0; border: 1px solid rgba(59,130,246,0.3); }
    .token-balance .amount { font-size: 1.3rem; font-weight: bold; color: var(--accent); }

    /* Overlay */
    .modal-overlay {
      display: none; position: fixed; inset: 0;
      background: rgba(0,0,0,0.7); z-index: 999; backdrop-filter: blur(5px);
    }
    .modal-overlay.active { display: block; }
  </style>
</head>
<body>

  <!-- Header -->
  <header>
    <h1>NFT Shooter Mobile</h1>
    <div id="walletStatus">Not connected</div>
    <button id="connectBtn">Connect</button>
  </header>

  <!-- Canvas -->
  <div id="canvas-container"></div>

  <!-- Instructions -->
  <div id="instructions">
    <div>Tap controls to move • Look with left circle • Tap gun to shoot</div>
  </div>

  <!-- Mobile Controls -->
  <div id="mobile-controls">
    <div class="mobile-btn" id="forward-btn">Up</div>
    <div style="display:flex;gap:10px;">
      <div class="mobile-btn" id="left-btn">Left</div>
      <div class="mobile-btn" id="backward-btn">Down</div>
      <div class="mobile-btn" id="right-btn">Right</div>
    </div>
    <div class="mobile-btn" id="shoot-btn">Gun</div>
  </div>
  <div id="look-controls"></div>

  <!-- Sidebar Toggle -->
  <button id="sidebar-toggle">Menu</button>

  <!-- Sidebar -->
  <div id="sidebar">
    <div id="sidebar-content">
      <div class="section">
        <h3>Stats</h3>
        <div class="info"><span class="label">Health:</span><span class="value" id="health-value">50/50</span></div>
        <div class="info"><span class="label">Bullets:</span><span class="value" id="bullet-count">100</span></div>
        <div class="info"><span class="label">Score:</span><span class="value" id="score-value">0</span></div>
      </div>
      <div class="section">
        <h3>ENJ</h3>
        <div class="token-balance"><div class="amount" id="token-balance">0 ENJ</div></div>
        <button id="transfer-token-btn-sidebar" class="btn">Transfer</button>
        <button id="purchase-token-btn-sidebar" class="btn btn-green">Get ENJ</button>
      </div>
    </div>
  </div>

  <!-- Avatar Selection -->
  <div id="avatar-selection">
    <h2>Choose Avatar</h2>
    <div class="avatar-options">
      <div class="avatar-option" id="boy-avatar" data-avatar="boy"></div>
      <div class="avatar-option" id="girl-avatar" data-avatar="girl"></div>
    </div>
    <input type="text" id="player-name" placeholder="Your name" maxlength="15">
    <button id="confirm-avatar">Start Game</button>
  </div>

  <!-- Overlay -->
  <div class="modal-overlay"></div>

</body>
</html>
